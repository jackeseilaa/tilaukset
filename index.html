<script>
  // STATE
  const state = {
    activeTab: "dashboard",
    sailings: [
      {
        id: "E001",
        date: "2026-05-21",
        name: "Purjehduskurssi",
        price: 560
      }
    ],
    customers: [
      {
        id: "V001",
        name: "Sauli Ketola",
        sailingId: "E001",
        price: 476,
        status: "Varaus"
      }
    ]
  };

  function render() {
    renderNav();
    renderContent();
  }

  function renderNav() {
    const nav = document.getElementById("nav");
    const tabs = [
      { id: "dashboard", label: "Dashboard" },
      { id: "sailings", label: "Purjehdukset" },
      { id: "customers", label: "Asiakkaat" },
      { id: "invoicing", label: "Laskutus" }
    ];

    nav.innerHTML = tabs.map(t => `
      <button data-tab="${t.id}" class="${state.activeTab === t.id ? "active" : ""}">
        ${t.label}
      </button>
    `).join("");

    nav.querySelectorAll("button[data-tab]").forEach(btn => {
      btn.addEventListener("click", () => {
        state.activeTab = btn.dataset.tab;
        render();
      });
    });
  }

  function renderContent() {
    const app = document.getElementById("app");

    if (state.activeTab === "dashboard") {
      app.innerHTML = `
        <div class="card">
          <strong>Purjehduksia:</strong> ${state.sailings.length}<br>
          <strong>Asiakkaita:</strong> ${state.customers.length}
        </div>
      `;
      return;
    }

    if (state.activeTab === "sailings") {
      app.innerHTML = `
        <div class="card">
          <h3>Purjehdukset</h3>
          ${state.sailings.map(s => `
            <div style="margin-top:10px;padding:10px;border:1px solid #ddd">
              <strong>${s.name}</strong><br>
              ${s.date}<br>
              ${s.price} €
            </div>
          `).join("")}
        </div>
      `;
      return;
    }

    if (state.activeTab === "customers") {
      app.innerHTML = `
        <div class="card">
          <h3>Asiakkaat</h3>
          ${state.customers.map(c => {
            const sailing = state.sailings.find(s => s.id === c.sailingId);
            return `
              <div style="margin-top:10px;padding:10px;border:1px solid #ddd">
                <strong>${c.name}</strong><br>
                Purjehdus: ${sailing ? sailing.name : c.sailingId}<br>
                ${c.price} €<br>
                Tila: ${c.status}
              </div>
            `;
          }).join("")}
        </div>
      `;
      return;
    }

    if (state.activeTab === "invoicing") {
      app.innerHTML = `
        <div class="card">
          Laskutusnäkymä lisätään seuraavaksi.
        </div>
      `;
      return;
    }
  }

  try {
    render();
  } catch (e) {
    document.getElementById("app").innerHTML =
      "<pre style='color:#b00020'>" + (e.stack || e) + "</pre>";
  }
</script>
